# 18장: 패턴과 매칭

Rust의 *패턴(Pattern)* 은 데이터의 구조를 해체하고 매칭할 수 있는 문법입니다.
이를 통해 `match`, `if let`, 함수 파라미터 등 다양한 구문에서 데이터 구조를 분해하고 조건에 맞는 로직을 실행할 수 있습니다.

---

## 1. 패턴이 쓰이는 곳

패턴은 다음과 같은 곳에서 사용됩니다:

* **`match` 갈래**

    * 모든 경우를 반드시 처리해야 함 (철저성, exhaustive).
    * 마지막 갈래에 `_` 사용 가능.
* **`if let`, `else if let`**

    * 특정 경우만 간단히 처리할 때 유용.
* **`while let`**

    * 값이 `Some`인 동안 반복 실행.
* **`for` 루프**

    * 튜플, 구조체 등 반복자 값 해체 가능.
* **`let` 구문**

    * 튜플 해체 (`let (x, y) = (1, 2);`).
* **함수/클로저 매개변수**

    * 함수 인자에서 구조체, 튜플 해체 가능.

---

## 2. 반박 가능성과 불가능성

* **반박 불가능한 패턴 (Irrefutable)**

    * 항상 매칭 성공.
    * 예: `let x = 5;` (무조건 매칭).
* **반박 가능한 패턴 (Refutable)**

    * 특정 값에는 매칭 실패 가능.
    * 예: `if let Some(x) = value` (값이 `None`이면 실패).
* 규칙:

    * `let`, 함수 매개변수, `for` 루프 → 반드시 *반박 불가능* 패턴.
    * `if let`, `while let` → *반박 가능한* 패턴 허용.

---

## 3. 패턴 문법

### 기본 매칭

* **리터럴**: `x @ 1..=5`, `Some(3)`, `'a'`
* **변수 바인딩**: 이름이 패턴이 되며 값과 매칭.
* **다중 패턴**: `1 | 2 | 3`
* **범위**: `1..=5`, `'a'..='z'`

### 해체 (Destructuring)

* **구조체**

  ```rust
  let Point { x, y } = p;
  ```
* **열거형**

  ```rust
  match msg {
      Message::Move { x, y } => println!("move to {x}, {y}"),
      Message::Write(s) => println!("msg: {s}"),
  }
  ```
* **튜플**

  ```rust
  let (a, _, b) = (1, 2, 3);
  ```

### 무시하기

* `_`: 전체 값 무시
* `_x`: 사용하지 않지만 바인딩 필요할 때
* `..`: 나머지 필드/요소 무시

  ```rust
  let Point { x, .. } = p;
  let (first, .., last) = tuple;
  ```

### 매치 가드 (Match Guard)

* 패턴 뒤 `if 조건`을 붙여 추가 제약 가능.

  ```rust
  match num {
      Some(x) if x % 2 == 0 => println!("짝수"),
      _ => println!("기타"),
  }
  ```

### `@` 바인딩

* 매칭과 동시에 값 바인딩.

  ```rust
  match msg {
      Message::Hello { id: id_var @ 3..=7 } =>
          println!("id in range: {id_var}"),
      _ => {}
  }
  ```

---

## 핵심 요약

* 패턴은 **데이터 구조를 해체하고 조건부 로직을 간결하게 표현**하는 도구.
* **위치**: `match`, `if let`, `while let`, `for`, `let`, 함수 매개변수 등.
* **반박 가능성**:

    * `let`, 함수 인자 → 반드시 불가능 패턴만.
    * `if let`, `while let` → 가능 패턴 허용.
* **문법 요소**:

    * 리터럴, 변수, 다중 패턴(`|`), 범위(`..=`).
    * 구조체, 열거형, 튜플 해체.
    * 무시(`_`, `..`), 매치 가드(`if`), `@` 바인딩.
