# 5장: 구조체와 메서드 문법 정리

### 1. 메서드 개념

* 메서드는 함수와 유사하지만 `impl` 블록 안에 정의되며 특정 구조체와 연관됨.
* 첫 번째 매개변수는 항상 `self`이며, 이는 해당 구조체 인스턴스를 나타냄.
* `self` 사용 방식

    * `&self`: 불변 참조
    * `&mut self`: 가변 참조
    * `self`: 소유권 이동

---

### 2. 메서드 정의하기

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    // 면적 계산 메서드
    fn area(&self) -> u32 {
        self.width * self.height
    }
}

fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };
    println!("면적: {}", rect1.area()); // 메서드 호출
}
```

* `area(&self)`는 `Rectangle`의 불변 참조만 사용 → 데이터 소유권 이동 없음.
* 메서드를 쓰면 관련 기능을 구조체 내부에 모아 코드의 응집도가 올라감.

---

### 3. 필드와 같은 이름의 메서드

```rust
impl Rectangle {
    fn width(&self) -> bool {
        self.width > 0
    }
}
```

* `rect.width` → 필드 참조
* `rect.width()` → 메서드 호출
* 러스트는 필드 게터를 자동 생성하지 않으므로, 필요시 직접 정의해야 함.

---

### 4. 자동 참조 및 역참조

* 러스트는 C/C++의 `->` 연산자가 없음.
* 대신 메서드 호출 시 `&`, `&mut`, `*`를 자동으로 삽입.

```rust
p1.distance(&p2);   // 일반 호출
(&p1).distance(&p2); // 자동 참조 해제 적용, 동일한 의미
```

---

### 5. 매개변수가 있는 메서드

```rust
impl Rectangle {
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}

fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };
    let rect2 = Rectangle { width: 10, height: 40 };
    println!("rect1이 rect2를 포함? {}", rect1.can_hold(&rect2));
}
```

* `self` 뒤에 일반 매개변수 추가 가능.
* `&Rectangle`를 인자로 받아 소유권 이동 없이 비교 가능.

---

### 6. 연관 함수 (Associated Function)

* `impl` 블록 내 함수이지만 `self`를 받지 않음.
* 주로 생성자 역할에 사용.

```rust
impl Rectangle {
    fn square(size: u32) -> Self {
        Self { width: size, height: size }
    }
}

fn main() {
    let sq = Rectangle::square(3); // 연관 함수 호출
}
```

* 호출 시 `::` 구문 사용 (`Rectangle::square(3)`).

---

### 7. 여러 개의 `impl` 블록

```rust
impl Rectangle {
    fn area(&self) -> u32 { self.width * self.height }
}

impl Rectangle {
    fn can_hold(&self, other: &Rectangle) -> bool {
        self.width > other.width && self.height > other.height
    }
}
```

* 하나의 구조체에 대해 여러 `impl` 블록 작성 가능.
* 제네릭, 트레이트 구현 시 유용.

---

### 8. 정리

* 구조체: 의미 있는 커스텀 타입을 정의하고 관련 데이터를 묶음.
* `impl` 블록: 해당 타입의 동작(메서드/연관 함수)을 정의.
* 메서드: `self`를 인자로 받아 인스턴스 기반 동작을 수행.
* 연관 함수: 인스턴스 없이 호출 가능한 함수, 주로 생성자 역할.
* 여러 `impl` 블록 사용 가능.
