# 2장: 추리 게임 (Guessing Game)

이 장은 **실습 프로젝트**로 러스트의 기초 개념들을 자연스럽게 익히는 과정입니다.
`let`, `match`, 메서드, 연관 함수, 외부 크레이트 사용법 등을 직접 코딩하며 배우게 됩니다.

---

## 1. 프로젝트 준비

```bash
$ cargo new guessing_game
$ cd guessing_game
```

* `cargo new` → 새로운 프로젝트 생성
* `cargo run` → 빠르게 반복 실행 가능

---

## 2. 사용자 입력 처리

### 코드 작성 (예제 2-1)

```rust
use std::io; // 표준 입력/출력 라이브러리 가져오기

fn main() {
    println!("Guess the number!"); // 안내 메시지

    let mut guess = String::new(); // 가변 문자열 변수 생성
    io::stdin()
        .read_line(&mut guess) // 사용자 입력 받기
        .expect("Failed to read line"); // 에러 처리

    println!("You guessed: {guess}"); // 자리표시자로 출력
}
```

### 주요 개념

* `let mut` → 가변 변수 선언
* `String::new()` → 빈 문자열 생성
* `&mut guess` → 가변 참조 전달
* `Result` 타입 → 성공(`Ok`)/실패(`Err`) 표현
* `.expect("메시지")` → 실패 시 프로그램 종료

---

## 3. 비밀번호(정답) 생성

### Cargo.toml 수정

```toml
[dependencies]
rand = "0.8.5"
```

### 코드 (예제 2-3)

```rust
use rand::Rng;

fn main() {
    let secret_number = rand::thread_rng().gen_range(1..=100);
    println!("The secret number is: {secret_number}");
}
```

* `rand::thread_rng()` → 현재 스레드 전용 난수 생성기
* `gen_range(1..=100)` → 1\~100 범위 난수 생성

---

## 4. 입력값과 정답 비교

### 코드 (예제 2-4)

```rust
use std::cmp::Ordering;

match guess.cmp(&secret_number) {
    Ordering::Less => println!("Too small!"),
    Ordering::Greater => println!("Too big!"),
    Ordering::Equal => println!("You win!"),
}
```

* `cmp` 메서드 → 두 값을 비교 (`Ordering::Less`, `Greater`, `Equal`)
* `match` 표현식 → 패턴 매칭으로 결과 처리

### 입력값 타입 변환

```rust
let guess: u32 = guess.trim().parse()
    .expect("Please type a number!");
```

* `trim()` → 개행 문자 제거
* `parse::<u32>()` → 문자열을 정수로 변환
* **섀도잉(Shadowing)**: 기존 변수 `guess`를 새 타입으로 재사용

---

## 5. 반복문 추가

### 무한 루프

```rust
loop {
    // 입력 요청 ~ 비교 코드 전체
}
```

* 무한 입력 가능
* `Ctrl+C`로 강제 종료 가능
* 정답 시 종료 → `break` 사용

---

## 6. 잘못된 입력 처리

### 코드 (예제 2-5)

```rust
let guess: u32 = match guess.trim().parse() {
    Ok(num) => num,
    Err(_) => continue, // 숫자가 아니면 루프 처음으로 돌아감
};
```

* `Result` 타입을 `match`로 처리
* 숫자가 아니면 무시하고 다음 입력을 요청

---

## 7. 완성된 게임 (예제 2-6)

```rust
use std::io;
use rand::Rng;
use std::cmp::Ordering;

fn main() {
    let secret_number = rand::thread_rng().gen_range(1..=100);

    loop {
        println!("Please input your guess.");

        let mut guess = String::new();
        io::stdin()
            .read_line(&mut guess)
            .expect("Failed to read line");

        let guess: u32 = match guess.trim().parse() {
            Ok(num) => num,
            Err(_) => continue,
        };

        println!("You guessed: {guess}");

        match guess.cmp(&secret_number) {
            Ordering::Less => println!("Too small!"),
            Ordering::Greater => println!("Too big!"),
            Ordering::Equal => {
                println!("You win!");
                break;
            }
        }
    }
}
```

---

## 8. 핵심 요약

* **입출력**: `std::io`, `read_line`
* **에러 처리**: `Result`, `.expect()`, `match`
* **난수 생성**: `rand` 크레이트, `gen_range`
* **타입 변환**: `.trim().parse()`
* **흐름 제어**: `match`, `loop`, `break`
* **섀도잉**: 변수 이름 재사용 가능
